# WebPen

https://github.com/topics/xss-poc

## インジェクション系のまとめ

|  脆弱性  |  インターフェース  |  悪用手口  | データの終端  |
| ---- | ---- |---- |---- |
|  XSS  |  HTML  | JavaScriptなどの注入  | `<` `"` など  |
|  SQLi  |  SQL  | SQL 命令の注入 | `'` など  |
|  RCE  |  シェルスクリプト  | コマンドの注入  | `;` `\|` など  |
|  HTTPヘッダ・インジェクション  |  HTTP  | HTTP レスポンスヘッダの注入  | 改行 |
|  メールヘッダ・インジェクション  |  sendmail コマンド  | メールヘッダ、本文注入・改変 | 改行 |

## PHP
PHP は C言語で開発された言語

### 入力値検証
+ バイナリセーフ   
バイナリセーフとは、バイナリデータ（どんなバイト列であってもデータ）を正しく扱うことができる関数   
典型的には値ゼロのバイト（ヌルバイト、PHP言語では \0 ）   
ヌルバイトを正しく扱えない関数をバイナリセーフではない関数(例:erep など)といい、検査対象文字列にヌルバイトがあると、そこで文字列が終わっていると判断するため、XSS などの脆弱性となる。
+ ヌルバイト攻撃   
C言語および Unix や Windows の API では、ヌルバイトを文字列の終端と見なる取り決めがされている。   
C言語で開発された PHP言語などのバイナリセーフな関数は、nullバイト（「\0」、「\x00」などの終端文字とされている文字列）を含めることでセキュリティチェックをくぐり抜けてしまう。
※ ヌルバイトは制御文字の一種

|  ASCII文字  |  説明  |  URLエンコード  |
| ---- | ---- | ---- |
| NUL | ヌル文字 | %00 |
| CR	| キャリッジリターン |	%0D |

ヌルバイト攻撃との組み合わせとして多い脆弱性は XSS のほか、ディレクトリ・トラバーサルなどがある。    
対策は、入力値検証やバイナリセーフの関数を使うこと。

### XSS
XSS には、以下 3つのタイプがある。
+ 反射型 XSS（reflected XSS）
+ 持続型 XSS（stored XSS）
+ DOM base XSS


## スキルアップ方法
* 「安全なウェブサイトの作り方」を読む
* hackerone の公開されているものを読む
* 安全な Web アプリケーションの作り方を読む

## 一覧
+ XXE
+ XSS
+ CSRF
+ CSS Injection
+ SQL Injection
+ RCE
+ SSTI
+ SSRF
+ Server-Side Includes Injection
+ Directory Traversal
+ HTTP request smuggling
+ INsecure Deserialization
